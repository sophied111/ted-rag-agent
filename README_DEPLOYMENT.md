# TED Talk RAG Assistant - Vercel Deployment Guide

## ğŸ“‹ Prerequisites

1. **Vercel Account**: Sign up at [vercel.com](https://vercel.com)
2. **API Keys**:
   - `OPENAI_API_KEY` - Your LLMOD AI API key
   - `PINECONE_API_KEY` - Your Pinecone API key
   - `PINECONE_INDEX` - Your Pinecone index name
   - `EMBEDDING_API_KEY` - (Optional) Separate embedding API key

3. **Completed Experiment**: Run `embedding_and_retreival_hyperparameter_experiments.py` to generate `best_config.json`

## ğŸš€ Deployment Steps

### 1. Prepare Your Project

Make sure you have:
- `best_config.json` - Generated from hyperparameter tuning
- `api/prompt.py` - POST endpoint for queries
- `api/stats.py` - GET endpoint for configuration
- `requirements.txt` - Python dependencies
- `vercel.json` - Vercel configuration
- `index.html` - Web interface

### 2. Install Vercel CLI (Optional)

```bash
npm install -g vercel
```

### 3. Deploy via Vercel CLI

```bash
# Login to Vercel
vercel login

# Deploy (first time)
vercel

# Follow prompts:
# - Set up and deploy? Y
# - Which scope? [Select your account]
# - Link to existing project? N
# - Project name? [Accept or customize]
# - In which directory is your code located? ./

# Deploy to production
vercel --prod
```

### 4. Deploy via Vercel Dashboard

1. Go to [vercel.com/new](https://vercel.com/new)
2. Import your Git repository (or upload files)
3. Configure project:
   - **Framework Preset**: Other
   - **Root Directory**: `./`
   - **Build Command**: (leave empty)
   - **Output Directory**: (leave empty)

4. Add Environment Variables:
   - `OPENAI_API_KEY`
   - `PINECONE_API_KEY`
   - `PINECONE_INDEX`
   - `EMBEDDING_API_KEY` (optional)

5. Click **Deploy**

### 5. Set Environment Variables (CLI)

```bash
vercel env add OPENAI_API_KEY
vercel env add PINECONE_API_KEY
vercel env add PINECONE_INDEX
vercel env add EMBEDDING_API_KEY
```

## ğŸ§ª Testing Your Deployment

### Test Stats Endpoint
```bash
curl https://your-app.vercel.app/api/stats
```

Expected response:
```json
{
  "chunk_size": 1024,
  "overlap_ratio": 0.2,
  "top_k": 10
}
```

### Test Prompt Endpoint
```bash
curl -X POST https://your-app.vercel.app/api/prompt \
  -H "Content-Type: application/json" \
  -d '{"question": "Find a TED talk about brain and consciousness"}'
```

Expected response:
```json
{
  "response": "Based on the provided context...",
  "context": [
    {
      "talk_id": "2817",
      "title": "How your brain hallucinates your conscious reality",
      "chunk": "...",
      "score": 0.8543
    }
  ],
  "Augmented_prompt": {
    "System": "You are a TED Talk assistant...",
    "User": "Use ONLY the following TED dataset context..."
  }
}
```

## ğŸ“ File Structure

```
your-project/
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ prompt.py          # POST /api/prompt endpoint
â”‚   â””â”€â”€ stats.py           # GET /api/stats endpoint
â”œâ”€â”€ best_config.json       # Generated from tuning (REQUIRED)
â”œâ”€â”€ index.html             # Web interface
â”œâ”€â”€ requirements.txt       # Python dependencies
â”œâ”€â”€ vercel.json           # Vercel configuration
â”œâ”€â”€ .vercelignore         # Files to exclude from deployment
â””â”€â”€ README_DEPLOYMENT.md  # This file
```

## âš™ï¸ Configuration

### vercel.json
Configures routing and environment variables. Already set up for you.

### best_config.json
Generated by running `embedding_and_retreival_hyperparameter_experiments.py`. Contains:
```json
{
  "scheme_id": "cs1024_ol20",
  "chunk_size": 1024,
  "overlap_ratio": 0.2,
  "top_k": 10
}
```

## ğŸ”§ Troubleshooting

### Error: Missing environment variables
- Make sure all API keys are set in Vercel dashboard: **Settings â†’ Environment Variables**
- Redeploy after adding variables

### Error: Module not found
- Check `requirements.txt` has all dependencies
- Redeploy to reinstall dependencies

### Error: best_config.json not found
- Run the hyperparameter tuning script first
- Make sure `best_config.json` is committed to your repository
- Check `.vercelignore` doesn't exclude it

### Error: Pinecone namespace not found
- Ensure you've run the embedding script with `FORCE_REEMBED=true`
- Verify the scheme_id in `best_config.json` matches your Pinecone namespaces
- Check your Pinecone index has the correct namespaces

## ğŸ“Š API Endpoints

### POST /api/prompt
Query the RAG system.

**Request:**
```json
{
  "question": "Your question here"
}
```

**Response:**
```json
{
  "response": "AI-generated answer",
  "context": [
    {
      "talk_id": "123",
      "title": "Talk Title",
      "chunk": "Retrieved text",
      "score": 0.95
    }
  ],
  "Augmented_prompt": {
    "System": "System prompt",
    "User": "Full user prompt with context"
  }
}
```

### GET /api/stats
Get current RAG configuration.

**Response:**
```json
{
  "chunk_size": 1024,
  "overlap_ratio": 0.2,
  "top_k": 10
}
```

## ğŸŒ Production URL

After deployment, your app will be available at:
```
https://your-project-name.vercel.app
```

Submit this URL for your assignment!

## ğŸ’¡ Tips

1. **Test locally first**: Use `vercel dev` to test locally before deploying
2. **Monitor logs**: Check Vercel dashboard for function logs and errors
3. **Keep index active**: Ensure your Pinecone index stays active until grading
4. **Version control**: Commit `best_config.json` to your Git repository
5. **Budget tracking**: Monitor API usage to stay within $5 budget

## ğŸ“ Assignment Checklist

- [ ] `best_config.json` generated and deployed
- [ ] Both API endpoints working (test with curl)
- [ ] Environment variables set correctly
- [ ] Pinecone index populated with embeddings
- [ ] Web interface accessible
- [ ] Public URL submitted for grading
- [ ] API returns correct JSON format

Good luck! ğŸ‰
